(function(e,t,n,r){function u(t,n){this.element=e(t);this.id=E.generateUID();this.options=e.extend({},o,n);this._defaults=o;this.init()}function a(t){this.container=t;this.domElement=e('<span class="jvodgallery-close"><span>&times;</span></span>').appendTo(this.container.domElement);E.addClickHandler(this.domElement,this.container.hideGallery,this.container)}function f(t){this.container=t;this.images={};this.actualImage=0;this.domElement=e('<div class="jvodgallery-img-container-outer"></div>').appendTo(this.container.domElement);var n=this.container.getImageTags();n.each(e.proxy(function(t,n){var r=e(n).data("id");if(typeof r=="undefined"){r=E.generateUID()}this.images[r]=new l(this,n)},this));s.addEventListener("resize",e.proxy(this.resize,this))}function l(t,n){this.container=t;this.imageTag=n;this.domElement=e('<div class="jvodgallery-img-item"></div>').appendTo(this.container.domElement);this.hidden=false;e('<div class="jvodgallery-img-item-inner"></div>').appendTo(this.domElement).append(this.imageTag);this.resize(E.getViewportDimensions().width,E.getViewportDimensions().height);s.addEventListener("resize",e.proxy(this.resize,this))}function c(t,n){this.container=t;this.imageContainer=n;this.domElement=e('<span class="jvodgallery-left"><span><</span></span>').appendTo(this.container.domElement);if(this.imageContainer.actualImage==0){this.domElement.hide()}s.addEventListener("page-right",e.proxy(this.movedRight,this));s.addEventListener("page-left",e.proxy(this.movedLeft,this));E.addClickHandler(this.domElement,this.moveLeft,this)}function h(t,n){this.container=t;this.imageContainer=n;this.domElement=e('<span class="jvodgallery-right"><span>></span></span>').appendTo(this.container.domElement);if(this.imageContainer.actualImage==this.imageContainer.images.length-1){this.domElement.hide()}s.addEventListener("page-left",e.proxy(this.movedLeft,this));s.addEventListener("page-right",e.proxy(this.movedRight,this));E.addClickHandler(this.domElement,this.moveRight,this)}function p(t){this.container=t;this.domElement=e('<div class="jvodgallery-preview-container"></div>').appendTo(this.container.domElement);this.imageContainer=e('<div class="jvodgallery-preview-container-inner"></div>').appendTo(this.domElement);this.scrollContainer=e('<div class="jvodgallery-preview-container-scroll"></div>').appendTo(this.imageContainer);this.logoElement=e('<div class="jvodgallery-logo">'+'<img src="'+this.container.getSetting("logoImg")+'"/>'+"</div>").appendTo(this.domElement);this.previewImages=[];this.displacement=0;this.switch=new d(this);this.previewRightPager=new m(this);this.previewLeftPager=new v(this);s.addEventListener("resize",e.proxy(this.resize,this));s.addEventListener("page-left",e.proxy(this.viewerMovedLeft,this));s.addEventListener("page-right",e.proxy(this.viewerMovedRight,this));this.initState();this.previewLeftPager.initState();this.previewRightPager.initState();this.switch.initState()}function d(t){this.container=t;this.isOpen=r;this.domElement=e('<div class="jvodgallery-preview-container-switch"><span></span></div>').appendTo(this.container.domElement);E.addClickHandler(this.domElement,this.togglePreview,this)}function v(t){this.container=t;this.domElement=e('<span class="jvodgallery-preview-left"><span>&laquo;</span></span>').appendTo(this.container.domElement);s.addEventListener("resize",e.proxy(this.initState,this));s.addEventListener("page-preview-right",e.proxy(this.movedRight,this));s.addEventListener("page-preview-left",e.proxy(this.movedLeft,this));E.addClickHandler(this.domElement,this.moveLeft,this)}function m(t){this.container=t;this.domElement=e('<span class="jvodgallery-preview-right"><span>&raquo;</span></span>').appendTo(this.container.domElement);s.addEventListener("gallery-show",e.proxy(this.initState,this));s.addEventListener("resize",e.proxy(this.initState,this));s.addEventListener("page-preview-left",e.proxy(this.movedLeft,this));s.addEventListener("page-preview-right",e.proxy(this.movedRight,this));E.addClickHandler(this.domElement,this.moveRight,this)}function g(t,n,r){this.container=t;this.position=r;this.hidden=false;this.domElement=e('<div class="jvodgallery-preview-image"></div>').appendTo(this.container.scrollContainer);e('<div class="jvodgallery-preview-image-inner"></div>').appendTo(this.domElement).append(n);E.addClickHandler(this.domElement,this.pageToImage,this)}function y(t){this.container=t;this.domElement=e('<div class="jvodgallery-filter-panel"></div>').appendTo(this.container.domElement);this.filterElement=e('<div class="jvodgallery-filter-panel-container"></div>').appendTo(this.domElement);this.filterDomElements={};this.filterSettings=this.container.getSetting("filters");this.activeFilters={};this.hiddenImages={};this.imageCache={};this.imagePreviewCache={};new w(this);new b(this);for(var n in this.filterSettings){if("function"==typeof this.filterSettings[n]){this.filterSettings[n]=this.filterSettings[n]()}}for(var r in this.container.imageContainer.images){if(this.container.imageContainer.images.hasOwnProperty(r)){this.imageCache[r]=this.container.imageContainer.images[r]}}for(var i in this.container.previewContainer.previewImages){if(this.container.previewContainer.previewImages.hasOwnProperty(i)){this.imagePreviewCache[i]=this.container.previewContainer.previewImages[i]}}for(var s in this.filterSettings){if(this.filterSettings.hasOwnProperty(s)){this.filterDomElements[s]=e('<select id="filter-select-'+s+'" data-filter="'+s+'"></select>').appendTo(e("<label></label>").appendTo(this.filterElement));for(var o in this.filterSettings[s]){if(this.filterSettings[s].hasOwnProperty(o)){e('<option value="'+o+'">'+o+"</option>").appendTo(this.filterDomElements[s]);var u={};for(var a in this.container.imageContainer.images){if(this.container.imageContainer.images.hasOwnProperty(a)){this.filterSettings[s][o]=this.filterSettings[s][o].map(function(e){return e+""});if(this.filterSettings[s][o].indexOf(a)>-1){u[a]=1}else{u[a]=-1}}}this.filterSettings[s][o]=u}}this.filterSettings[s]["All "+s]={};for(var f in this.container.imageContainer.images){if(this.container.imageContainer.images.hasOwnProperty(f)){this.filterSettings[s]["All "+s][f]=0}}e('<option selected="selected" value="All '+s+'">All '+s+"</option>").prependTo(this.filterDomElements[s]);if("function"==typeof e()["ddslick"]){this.filterDomElements[s].ddslick({width:"190px",onSelected:e.proxy(function(e){var t=e.original[0].id.substring(14);this.filterDomElements[t].val=function(){return e.selectedData.value};this.filterChange(t)},this)})}else{E.addChangeHandler(this.filterDomElements[s],this.filterChange,this,[s])}}}}function b(t){this.isFilterElementClosed=true;this.container=t;this.isOpen=r;this.domElement=e('<div class="jvodgallery-filter-panel-switch"><span></span></div>').appendTo(this.container.domElement);this.initState();E.addClickHandler(this.domElement,this.toggleFilterPanel,this)}function w(t){this.container=t;this.titles=this.container.container.getSetting("titles");this.domElement=e('<div class="jvodgallery-preview-titlebar"></div>').appendTo(this.container.domElement);this.pageElement=e('<span class="jvodgallery-preview-titlebar-page"></span>').appendTo(this.domElement);this.titleElement=e('<span class="jvodgallery-preview-titlebar-title"></span>').appendTo(this.domElement);this.initState();s.addEventListener("page-left",e.proxy(this.updateTitlebar,this));s.addEventListener("page-right",e.proxy(this.updateTitlebar,this))}function E(){}function S(){this.events={}}function x(n){this.callback=n;this.rtime=new Date(1,1,2e3,12,0,0);this.timeout=false;this.delta=200;e(t).resize(e.proxy(function(){this.rtime=new Date;if(this.timeout===false){this.timeout=true;setTimeout(e.proxy(this.resizeEnd,this),this.delta)}},this))}var i="jVODGallery",s=new S,o={logoImg:"",imgSource:"",titles:{},filters:{}};u.prototype.init=function(){this.domElement=e('<div id="jvodgallery-'+this.id+'" data-id="'+this.id+'" class="jvodgallery-main">'+'   <div class="jvodgallery-dim"><div id="jvodgallery-no-image">We found no images for those filters</div></div>'+"</div>").appendTo("body");E.addClickHandler(this.element,this.showGallery,this);s.registerEvent("gallery-show");s.registerEvent("page-left");s.registerEvent("page-right");s.registerEvent("page-preview-left");s.registerEvent("page-preview-right");s.registerEvent("resize");var t=this.countImages();new a(this);this.imageContainer=new f(this);if(t>1){this.leftPager=new c(this,this.imageContainer);this.rightPager=new h(this,this.imageContainer);this.previewContainer=new p(this);this.filterPanel=new y(this)}new x(function(){var e=E.getViewportDimensions();s.dispatchEvent("resize",[e.width,e.height])})};u.prototype.getSetting=function(e){return typeof this.options[e]=="undefined"?this._defaults[e]:this.options[e]};u.prototype.showGallery=function(){this.domElement.show();s.dispatchEvent("gallery-show")};u.prototype.hideGallery=function(e){if(typeof e=="undefined"||e===true){this.resetState()}this.domElement.hide()};u.prototype.resetState=function(){this.imageContainer.resetState();if(this.previewContainer){this.previewContainer.resetState()}if(this.filterPanel){this.filterPanel.resetState()}};u.prototype.getImageTags=function(){var t=this.getSetting("imgSource");if(typeof t=="object"){var n=e('<ul id="jvodgallery-shadow-img-container-'+this.id+'" class="jvodgallery-shadow-img-container">'+"</ul>").appendTo("body");for(var r in t){if(t.hasOwnProperty(r)){e('<img src="'+t[r]+'" data-id="'+r+'"/>').appendTo(n)}}t=n.find("img")}if(typeof t=="string"){var n=e('<ul id="jvodgallery-shadow-img-container-'+this.id+'" class="jvodgallery-shadow-img-container">'+"</ul>").appendTo("body");try{e(t).each(function(t,r){e(r).clone().appendTo(n).data("id",0)});t=n.find("img")}catch(i){e('<img src="'+t+'" data-id="0"/>').appendTo(n);t=n.find("img")}}return t};u.prototype.countImages=function(){var e=this.getSetting("imgSource");if(typeof e=="object"){return Object.keys(e).length}if(typeof e=="string"){return 1}console.error("Wrong image gallery definition or no image in gallery");return-1};f.prototype.resize=function(e){this.domElement.css({width:this.images.length*e+"px","margin-left":this.actualImage*e*-1+"px"})};f.prototype.resetState=function(){this.actualImage=0;this.domElement.css("margin-left",0)};l.prototype.resize=function(e,t){this.domElement.css({width:e+"px",height:t+"px"})};l.prototype.hide=function(){this.domElement.hide();this.hidden=true};l.prototype.show=function(){this.domElement.show();this.hidden=false};c.prototype.movedRight=function(){this.domElement.show()};c.prototype.movedLeft=function(){if(this.imageContainer.actualImage==0){this.domElement.hide()}};c.prototype.moveLeft=function(e){var t=e;if(typeof e=="undefined"){t=1}this.imageContainer.actualImage-=t;this.imageContainer.domElement.animate({"margin-left":"+="+E.getViewportDimensions().width*t});s.dispatchEvent("page-left",[e])};h.prototype.movedLeft=function(){this.domElement.show()};h.prototype.movedRight=function(){if(this.imageContainer.actualImage==Object.keys(this.imageContainer.images).length-1){this.domElement.hide()}};h.prototype.moveRight=function(e){var t=e;if(typeof e=="undefined"){t=1}this.imageContainer.actualImage+=t;this.imageContainer.domElement.animate({"margin-left":"-="+E.getViewportDimensions().width*t});s.dispatchEvent("page-right",[e])};p.prototype.initState=function(){var t=0;for(var n in this.container.imageContainer.images){if(this.container.imageContainer.images.hasOwnProperty(n)){e.proxy(function(t,n){var r=new g(this,e(t.imageTag).clone(),n);if(this.container.imageContainer.actualImage==n){r.toggleActive()}this.previewImages.push(r)},this)(this.container.imageContainer.images[n],t++)}}var r=this.scrollContainer.find(".jvodgallery-preview-image").toArray().map(function(t){return e(t).outerWidth(true)}).reduce(function(e,t){return e+t},0);this.scrollContainer.css({width:r+"px"});this.domElement.css({"margin-bottom":"-"+this.domElement.outerHeight()+"px"})};p.prototype.resetState=function(){this.scrollContainer.css("margin-left",0);this.domElement.css({"margin-bottom":"-"+this.domElement.outerHeight()+"px"});this.displacement=0;this.domElement.find(".jvodgallery-preview-image").removeClass("jvodgallery-preview-image-active");if("undefined"!=typeof this.previewImages[0]){this.previewImages[0].toggleActive()}this.switch.resetState()};p.prototype.resize=function(){this.scrollActiveImageToView()};p.prototype.viewerMovedRight=function(e){if(typeof e=="undefined"){e=1}this.previewImages[this.container.imageContainer.actualImage-e].toggleActive();this.previewImages[this.container.imageContainer.actualImage].toggleActive();this.scrollActiveImageToView()};p.prototype.viewerMovedLeft=function(e){if(typeof e=="undefined"){e=1}this.previewImages[this.container.imageContainer.actualImage+e].toggleActive();this.previewImages[this.container.imageContainer.actualImage].toggleActive();this.scrollActiveImageToView()};p.prototype.scrollActiveImageToView=function(){var e=this.previewImages[this.container.imageContainer.actualImage];if("undefined"!=typeof e){var t=e.getPosition();if(t.left<=this.displacement){this.previewLeftPager.moveLeft(this.displacement-t.left)}if(t.right>this.displacement+this.imageContainer.width()){this.previewRightPager.moveRight(t.right-(this.displacement+this.imageContainer.width()))}}};d.prototype.initState=function(){this.resetState()};d.prototype.resetState=function(){var e=E.cookie();if("undefined"!=typeof e["previewcontainer"]&&"closed"==e["previewcontainer"]){this.isOpen=false;this.container.domElement.css({"margin-bottom":"-"+this.container.domElement.outerHeight()+"px"})}else{this.isOpen=true;this.container.domElement.css({"margin-bottom":"0px"})}};d.prototype.togglePreview=function(){if(this.isOpen){this.container.domElement.animate({"margin-bottom":"-="+this.container.domElement.outerHeight()});this.isOpen=false;n.cookie="previewcontainer=closed"}else{this.container.domElement.animate({"margin-bottom":"+="+this.container.domElement.outerHeight()});this.isOpen=true;n.cookie="previewcontainer=open"}};v.prototype.initState=function(){if(this.container.displacement==0){this.domElement.hide()}};v.prototype.movedRight=function(){this.domElement.show()};v.prototype.movedLeft=function(){if(this.container.displacement==0){this.domElement.hide()}};v.prototype.moveLeft=function(e){if(typeof e=="undefined"){e=this.container.imageContainer.width()/2}if(this.container.displacement-e<0){e=this.container.displacement}this.container.displacement-=e;this.container.scrollContainer.animate({"margin-left":"+="+e});s.dispatchEvent("page-preview-left",[e])};m.prototype.initState=function(){if(this.container.displacement+this.container.imageContainer.width()>=this.container.scrollContainer.width()){this.domElement.hide()}else{this.domElement.show()}};m.prototype.movedLeft=function(){if(this.container.displacement+this.container.imageContainer.width()>=this.container.scrollContainer.width()){this.domElement.hide()}else{this.domElement.show()}};m.prototype.movedRight=function(){if(this.container.displacement==this.container.scrollContainer.width()-this.container.imageContainer.width()){this.domElement.hide()}};m.prototype.moveRight=function(e){if(typeof e=="undefined"){e=this.container.imageContainer.width()/2}if(this.container.scrollContainer.width()-(this.container.displacement+e)<this.container.imageContainer.width()){e=this.container.scrollContainer.width()-this.container.imageContainer.width()-this.container.displacement}this.container.displacement+=e;this.container.scrollContainer.animate({"margin-left":"-="+e});s.dispatchEvent("page-preview-right",[e])};g.prototype.pageToImage=function(){var e=this.container.container.imageContainer.actualImage;if(e<this.position){this.container.container.rightPager.moveRight(this.position-e)}else if(e>this.position){this.container.container.leftPager.moveLeft(e-this.position)}};g.prototype.toggleActive=function(){this.domElement.toggleClass("jvodgallery-preview-image-active")};g.prototype.getPosition=function(){var e=this.domElement.position();e.right=e.left+this.domElement.outerWidth(true);return e};g.prototype.hide=function(){this.domElement.hide();this.hidden=true};g.prototype.show=function(){this.domElement.show();this.hidden=false};y.prototype.resetState=function(){this.filterElement.css({"margin-top":0});this.activeFilters={};for(var t in this.filterDomElements){if(this.filterDomElements.hasOwnProperty(t)){if("function"==typeof e()["ddslick"]){e("#filter-select-"+t).ddslick("select",{index:0})}else{this.filterDomElements[t].val("All "+t)}}}this.hiddenImages={};for(var n in this.imageCache){if(this.imageCache.hasOwnProperty(n)){this.hiddenImages[n]=0}}this.updateImageContainer();this.updatePreviewContainer()};y.prototype.filterChange=function(e){var t=this.filterDomElements[e].val();this.activeFilters[e]=this.filterSettings[e][t];this.hiddenImages={};for(var n in this.imageCache){if(this.imageCache.hasOwnProperty(n)){for(var r in this.activeFilters){if(this.activeFilters.hasOwnProperty(r)){if(this.activeFilters[r][n]==-1){this.hiddenImages[n]=-1}else if(this.hiddenImages[n]!=-1&&this.activeFilters[r][n]==1){this.hiddenImages[n]=1}else if(this.hiddenImages[n]!=1&&this.hiddenImages[n]!=-1){this.hiddenImages[n]=0}}}}}this.updateImageContainer();this.updatePreviewContainer()};y.prototype.updateImageContainer=function(){var t=true;for(var n in this.hiddenImages){if(this.hiddenImages.hasOwnProperty(n)){if(this.hiddenImages[n]>-1){this.container.imageContainer.images[n]=this.imageCache[n];this.imageCache[n].show();t=false}else{this.imageCache[n].hide();delete this.container.imageContainer.images[n]}}}if(t)e("#jvodgallery-no-image").show();else e("#jvodgallery-no-image").hide();this.container.imageContainer.actualImage=0;this.container.imageContainer.resize(E.getViewportDimensions().width);this.container.leftPager.movedRight();this.container.leftPager.movedLeft();this.container.rightPager.movedLeft();this.container.rightPager.movedRight()};y.prototype.updatePreviewContainer=function(){var e=0,t=0;this.container.previewContainer.previewImages=[];for(var n in this.hiddenImages){if(this.hiddenImages.hasOwnProperty(n)){if(this.hiddenImages[n]>-1){this.container.previewContainer.previewImages[t]=this.imagePreviewCache[e];this.container.previewContainer.previewImages[t].position=t;this.imagePreviewCache[e].show();t++}else{this.imagePreviewCache[e].hide()}}e++}this.container.previewContainer.displacement=0;var r=this.container.previewContainer.previewImages.map(function(e){return e.domElement.outerWidth(true)}).reduce(function(e,t){return e+t},0);this.container.previewContainer.scrollContainer.css({"margin-left":0,width:r+"px"});this.container.previewContainer.domElement.find(".jvodgallery-preview-image").removeClass("jvodgallery-preview-image-active");if("undefined"!=typeof this.container.previewContainer.previewImages[0]){this.container.previewContainer.previewImages[0].toggleActive()}this.container.previewContainer.previewRightPager.movedLeft();this.container.previewContainer.previewLeftPager.movedRight();this.container.previewContainer.previewLeftPager.movedLeft()};b.prototype.initState=function(){this.resetState()};b.prototype.resetState=function(){var e=E.cookie();if("undefined"!=typeof e["filterpanel"]&&"closed"==e["filterpanel"]){this.isFilterElementClosed=true;this.container.domElement.css({"margin-top":"-"+this.container.domElement.outerHeight()+"px"})}else{this.isFilterElementClosed=false;this.container.domElement.css({"margin-top":"0px"})}};b.prototype.toggleFilterPanel=function(){if(this.isFilterElementClosed){this.container.domElement.animate({"margin-top":"+="+this.container.domElement.outerHeight()});this.isFilterElementClosed=false;n.cookie="filterpanel=open"}else{this.container.domElement.animate({"margin-top":"-="+this.container.domElement.outerHeight()});this.isFilterElementClosed=true;n.cookie="filterpanel=closed"}};w.prototype.initState=function(){this.updateTitlebar()};w.prototype.updateTitlebar=function(){var e=Object.keys(this.container.container.imageContainer.images);var t=this.titles[e[this.container.container.imageContainer.actualImage]];if(typeof e[this.container.container.imageContainer.actualImage]!="undefined"&&this.titles[e[this.container.container.imageContainer.actualImage]]!="undefined"&&"string"==typeof t&&t.length>0){this.titleElement.text(t)}else{this.titleElement.text("")}this.pageElement.text(this.container.container.imageContainer.actualImage+1+"/"+e.length)};E.cookie=function(){var e=n.cookie.split(";");var t=new Object;for(var r in e){var i=e[r].split("=");if(i.length==2){t[i[0].trim()]=i[1].trim()}}return t};E.generateUID=function(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)};E.addClickHandler=function(t,n,r,i){return e(t).click(function(e){e.preventDefault();return n.apply(typeof r=="undefined"?this:r,typeof i=="undefined"?[]:i)})};E.addChangeHandler=function(t,n,r,i){return e(t).change(function(e){e.preventDefault();return n.apply(typeof r=="undefined"?this:r,typeof i=="undefined"?[]:i)})};E.getViewportDimensions=function(){var e=Math.min(n.documentElement.clientWidth,t.innerWidth||100);var r=Math.min(n.documentElement.clientHeight,t.innerHeight||100);return{width:e,height:r}};S.Event=function(e){this.name=e;this.callbacks=[]};S.Event.prototype.registerCallback=function(e){this.callbacks.push(e)};S.prototype.registerEvent=function(e){if(typeof this.events[e]=="undefined"){this.events[e]=new S.Event(e)}};S.prototype.dispatchEvent=function(e,t){this.events[e].callbacks.forEach(function(e){e.apply(this,t)})};S.prototype.addEventListener=function(e,t){this.events[e].registerCallback(t)};x.prototype.resizeEnd=function(){if(new Date-this.rtime<this.delta){setTimeout(e.proxy(this.resizeEnd,this),this.delta)}else{this.timeout=false;this.callback()}};e.fn[i]=function(e){return this.each(function(){new u(this,e)})}})(jQuery,window,document)